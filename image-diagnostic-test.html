<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTV Image Loading Diagnostics</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #111;
            color: #fff;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #ff7700;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-item {
            background: #222;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 15px;
        }
        .test-item h3 {
            color: #ff7700;
            margin: 0 0 10px 0;
            font-size: 16px;
        }
        .image-container {
            position: relative;
            margin: 10px 0;
        }
        .test-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: border-color 0.3s;
        }
        .test-image.loaded {
            border-color: #00ff88;
        }
        .test-image.error {
            border-color: #ff4444;
            background: #333;
        }
        .image-status {
            font-size: 12px;
            margin-top: 5px;
            padding: 5px;
            border-radius: 4px;
        }
        .status-success {
            background: #004422;
            color: #00ff88;
        }
        .status-error {
            background: #442222;
            color: #ff4444;
        }
        .status-loading {
            background: #444422;
            color: #ffff88;
        }
        .fix-suggestions {
            background: #332211;
            border: 1px solid #ff7700;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        .fix-suggestions h3 {
            color: #ff7700;
            margin-top: 0;
        }
        .diagnostic-panel {
            background: #1a1a1a;
            border: 1px solid #ff7700;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .stat-item {
            background: #333;
            padding: 10px 15px;
            border-radius: 6px;
            text-align: center;
            min-width: 80px;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ff7700;
        }
        .stat-label {
            font-size: 12px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß CTV Image Loading Diagnostics</h1>
        
        <div class="diagnostic-panel">
            <h3>üìä Loading Statistics</h3>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-count">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="loaded-count">0</div>
                    <div class="stat-label">Loaded</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="error-count">0</div>
                    <div class="stat-label">Errors</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="success-rate">0%</div>
                    <div class="stat-label">Success Rate</div>
                </div>
            </div>
        </div>

        <div class="test-grid" id="image-grid">
            <!-- Images will be loaded here by JavaScript -->
        </div>

        <div class="fix-suggestions">
            <h3>üõ†Ô∏è Fix Suggestions</h3>
            <div id="suggestions-content">
                <p>üîÑ Running diagnostics...</p>
            </div>
        </div>
    </div>

    <script>
        const imageTests = [
            {
                category: 'Welding Services',
                images: [
                    { 
                        name: 'welding-project-1.jpg', 
                        path: 'assets/sample-photos/welding/welding-project-1.jpg',
                        alt: 'Professional Mobile Welding Services'
                    },
                    { 
                        name: 'welding-project-2.jpg', 
                        path: 'assets/sample-photos/welding/welding-project-2.jpg',
                        alt: 'Advanced Welding Project'
                    }
                ]
            },
            {
                category: 'Container Repair',
                images: [
                    { 
                        name: 'container-repair-1.jpg', 
                        path: 'assets/sample-photos/container-repair/container-repair-1.jpg',
                        alt: 'Expert Container Repair'
                    },
                    { 
                        name: 'container-repair-2.jpg', 
                        path: 'assets/sample-photos/container-repair/container-repair-2.jpg',
                        alt: 'Container Restoration'
                    }
                ]
            },
            {
                category: 'Pressure Washing',
                images: [
                    { 
                        name: 'pressure-washing-1.jpg', 
                        path: 'assets/sample-photos/pressure-washing/pressure-washing-1.jpg',
                        alt: 'Professional Pressure Washing'
                    },
                    { 
                        name: 'pressure-washing-2.jpg', 
                        path: 'assets/sample-photos/pressure-washing/pressure-washing-2.jpg',
                        alt: 'Equipment Cleaning'
                    }
                ]
            }
        ];

        let totalImages = 0;
        let loadedImages = 0;
        let errorImages = 0;
        const errorList = [];

        function updateStats() {
            document.getElementById('total-count').textContent = totalImages;
            document.getElementById('loaded-count').textContent = loadedImages;
            document.getElementById('error-count').textContent = errorImages;
            
            const successRate = totalImages > 0 ? Math.round((loadedImages / totalImages) * 100) : 0;
            document.getElementById('success-rate').textContent = successRate + '%';
            
            updateSuggestions();
        }

        function updateSuggestions() {
            const suggestionsDiv = document.getElementById('suggestions-content');
            
            if (errorImages === 0) {
                suggestionsDiv.innerHTML = `
                    <p style="color: #00ff88;">üéâ All images loaded successfully! No fixes needed.</p>
                    <p>‚úÖ All ${totalImages} images are displaying correctly</p>
                    <p>‚úÖ File permissions are properly set</p>
                    <p>‚úÖ Image paths are correct</p>
                `;
            } else {
                let suggestions = `<p style="color: #ff4444;">‚ùå ${errorImages} image(s) failed to load:</p><ul>`;
                
                errorList.forEach(error => {
                    suggestions += `
                        <li><strong>${error.name}</strong>
                            <ul>
                                <li>Path: ${error.path}</li>
                                <li>Error: ${error.error}</li>
                                <li>Suggested fix: Verify file exists and has proper permissions</li>
                            </ul>
                        </li>`;
                });
                
                suggestions += `</ul>
                    <h4>üîß Recommended Actions:</h4>
                    <ol>
                        <li>Check if files exist: <code>ls -la assets/sample-photos/*/</code></li>
                        <li>Set proper permissions: <code>chmod 644 assets/sample-photos/*/*.jpg</code></li>
                        <li>Verify server is serving static files correctly</li>
                        <li>Check browser console for CORS or network errors</li>
                    </ol>`;
                
                suggestionsDiv.innerHTML = suggestions;
            }
        }

        function testImage(imageInfo, container) {
            totalImages++;
            
            const img = document.createElement('img');
            const statusDiv = document.createElement('div');
            
            img.className = 'test-image';
            img.alt = imageInfo.alt;
            statusDiv.className = 'image-status status-loading';
            statusDiv.textContent = '‚è≥ Loading...';
            
            img.onload = function() {
                loadedImages++;
                img.classList.add('loaded');
                statusDiv.className = 'image-status status-success';
                statusDiv.innerHTML = `‚úÖ Loaded (${this.naturalWidth}x${this.naturalHeight}px)`;
                updateStats();
            };
            
            img.onerror = function() {
                errorImages++;
                img.classList.add('error');
                statusDiv.className = 'image-status status-error';
                statusDiv.textContent = '‚ùå Failed to load';
                
                errorList.push({
                    name: imageInfo.name,
                    path: imageInfo.path,
                    error: 'Failed to load image'
                });
                
                updateStats();
            };
            
            container.appendChild(img);
            container.appendChild(statusDiv);
            
            // Set src after event handlers are attached
            img.src = imageInfo.path;
        }

        function runDiagnostics() {
            const grid = document.getElementById('image-grid');
            
            imageTests.forEach(category => {
                category.images.forEach(imageInfo => {
                    const testItem = document.createElement('div');
                    testItem.className = 'test-item';
                    
                    const title = document.createElement('h3');
                    title.textContent = `${category.category}: ${imageInfo.name}`;
                    
                    const container = document.createElement('div');
                    container.className = 'image-container';
                    
                    testItem.appendChild(title);
                    testItem.appendChild(container);
                    grid.appendChild(testItem);
                    
                    testImage(imageInfo, container);
                });
            });
            
            updateStats();
        }

        // Start diagnostics when page loads
        document.addEventListener('DOMContentLoaded', runDiagnostics);
    </script>
</body>
</html>
